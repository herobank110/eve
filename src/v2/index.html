<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>David Kanekanian</title>
    <script src="https://flackr.github.io/scroll-timeline/dist/scroll-timeline.js"></script>
    <link rel="prefetch" as="image" href="flipbook/flipbook_1001.png" />
    <link rel="prefetch" as="image" href="flipbook/flipbook_1002.png" />
    <link rel="prefetch" as="image" href="flipbook/flipbook_1003.png" />
    <link rel="prefetch" as="image" href="flipbook/flipbook_1004.png" />
    <link rel="prefetch" as="image" href="flipbook/flipbook_1005.png" />
    <link rel="prefetch" as="image" href="flipbook/flipbook_1006.png" />
    <link rel="prefetch" as="image" href="flipbook/flipbook_1007.png" />
    <link rel="prefetch" as="image" href="flipbook/flipbook_1008.png" />
    <link rel="stylesheet" href="style.scss" />
    <script>
        let g_imgHeight = 0;
        function refreshImgHeight() {
            g_imgHeight = document.querySelector('.frameImg')?.clientHeight ?? 0;
            requestAnimationFrame(refreshImgHeight);
        }
        window.onload = () => {
            refreshImgHeight();
            const imgs = [...document.querySelectorAll(".frameImg")];
            document.body.style.height = `calc(${imgs.length} * 100lvh)`;
            const keyframes = [
                ...imgs.flatMap((_, i) =>
                    i == 0
                        ? Array(6).fill('0px')
                        : [
                            `-${(i - 1) * g_imgHeight}px`,
                            `-${(i - 1) * g_imgHeight}px`,
                            `-${(i - 1) * g_imgHeight}px`,
                            `-${Math.abs((i - 1) * g_imgHeight - 20)}px`,
                            `-${i * g_imgHeight - 10}px`,
                            `-${i * g_imgHeight}px`
                        ]),
            ].reverse();
            document.querySelector('.frameReel').animate(
                { top: keyframes },
                {
                    timeline: new ViewTimeline({ subject: document.body, orientation: 'block' }),
                    // timeRange: 'contain 25% 75%',
                    timeRange: 'contain',
                    fill: 'both'
                }
            )
        }
    </script>
</head>

<body>
    <div class="flipbookRoot">
        <div class="flipbookBorder">
            <div class="frameReel">
                <div class="frameImg" style="background-image:url('flipbook/flipbook_1008.png')"></div>
                <div class="frameImg" style="background-image:url('flipbook/flipbook_1007.png')"></div>
                <div class="frameImg" style="background-image:url('flipbook/flipbook_1006.png')"></div>
                <div class="frameImg" style="background-image:url('flipbook/flipbook_1005.png')"></div>
                <div class="frameImg" style="background-image:url('flipbook/flipbook_1004.png')"></div>
                <div class="frameImg" style="background-image:url('flipbook/flipbook_1003.png')"></div>
                <div class="frameImg" style="background-image:url('flipbook/flipbook_1002.png')"></div>
                <div class="frameImg" style="background-image:url('flipbook/flipbook_1001.png')"></div>
            </div>
        </div>
    </div>

</body>

</html>